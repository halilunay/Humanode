#!/usr/bin/env bash

source subnodes.env

# Burada her sunucu için bir blok hazırlayacağız.
# Örnek format:
# ALT SUNUCU ADI: IP
# USER_BOT_TOKEN="..."
# USER_CHAT_ID="..."
# OPERATOR_BOT_TOKEN="..."
# OPERATOR_CHAT_ID="..."
# NODE_NAME="..."

# Haun
HAUN_IP="152.53.32.15"
HAUN_USER_BOT_TOKEN="8164619399:AAHR9Zs5B-Gk0mMvlSx0lfiN-aWtC4BCZEw"
HAUN_USER_CHAT_ID="1686175963"
HAUN_OPERATOR_BOT_TOKEN="7014573028:AAEZqARcPde7rUEcAZdePJudkU6UG8u0gGc"
HAUN_OPERATOR_CHAT_ID="1686175963"
HAUN_NODE_NAME="haun"

# Arun
ARUN_IP="152.53.33.94"
ARUN_USER_BOT_TOKEN="7307063683:AAEjaKyOdnPAKUaNMbdH0fYvasQvaYdIvJ8"
ARUN_USER_CHAT_ID="6706302640"
ARUN_OPERATOR_BOT_TOKEN="7014573028:AAEZqARcPde7rUEcAZdePJudkU6UG8u0gGc"
ARUN_OPERATOR_CHAT_ID="1686175963"
ARUN_NODE_NAME="arun"

# Azun
AZUN_IP="152.53.35.28"
AZUN_USER_BOT_TOKEN="7523657669:AAEZiB4tFdEA_7eoy9cSV1fc3G10Ggo2yNE"
AZUN_USER_CHAT_ID="7147274770"
AZUN_OPERATOR_BOT_TOKEN="7014573028:AAEZqARcPde7rUEcAZdePJudkU6UG8u0gGc"
AZUN_OPERATOR_CHAT_ID="1686175963"
AZUN_NODE_NAME="azun"

# Ahun
AHUN_IP="152.53.35.44"
AHUN_USER_BOT_TOKEN="7753473928:AAERTlKN4VdRTu_8cVfue4KtzrtQ96bANh4"
AHUN_USER_CHAT_ID="6994400794"
AHUN_OPERATOR_BOT_TOKEN="7014573028:AAEZqARcPde7rUEcAZdePJudkU6UG8u0gGc"
AHUN_OPERATOR_CHAT_ID="1686175963"
AHUN_NODE_NAME="ahun"

# Esca (Kullanıcısı yok)
ESCA_IP="89.58.17.20"
ESCA_USER_BOT_TOKEN=""
ESCA_USER_CHAT_ID=""
ESCA_OPERATOR_BOT_TOKEN="7014573028:AAEZqARcPde7rUEcAZdePJudkU6UG8u0gGc"
ESCA_OPERATOR_CHAT_ID="1686175963"
ESCA_NODE_NAME="esca"

# Beca (Kullanıcısı yok)
BECA_IP="89.58.19.116"
BECA_USER_BOT_TOKEN=""
BECA_USER_CHAT_ID=""
BECA_OPERATOR_BOT_TOKEN="7014573028:AAEZqARcPde7rUEcAZdePJudkU6UG8u0gGc"
BECA_OPERATOR_CHAT_ID="1686175963"
BECA_NODE_NAME="beca"

# Inko
INKO_IP="89.58.60.188"
INKO_USER_BOT_TOKEN="7289279437:AAFgjT2zflk_d4qgXlapreHshQ96MFfU-jE"
INKO_USER_CHAT_ID="2055215962"
INKO_OPERATOR_BOT_TOKEN="7014573028:AAEZqARcPde7rUEcAZdePJudkU6UG8u0gGc"
INKO_OPERATOR_CHAT_ID="1686175963"
INKO_NODE_NAME="inko"

# Ahko
AHKO_IP="188.172.228.225"
AHKO_USER_BOT_TOKEN="8115596091:AAF_6iFHJTRVMBF0VfuXyW-JR3S18c-UZhI"
AHKO_USER_CHAT_ID="6794594082"
AHKO_OPERATOR_BOT_TOKEN="7014573028:AAEZqARcPde7rUEcAZdePJudkU6UG8u0gGc"
AHKO_OPERATOR_CHAT_ID="1686175963"
AHKO_NODE_NAME="ahko"

# Beer
BEER_IP="188.172.229.15"
BEER_USER_BOT_TOKEN="7547286279:AAHvS3jj1KfT6XUQDGIFP565qvRdFeIiEbU"
BEER_USER_CHAT_ID="7088936400"
BEER_OPERATOR_BOT_TOKEN="7014573028:AAEZqARcPde7rUEcAZdePJudkU6UG8u0gGc"
BEER_OPERATOR_CHAT_ID="1686175963"
BEER_NODE_NAME="beer"

# Tuav (Kullanıcısı yok)
TUAV_IP="188.172.229.223"
TUAV_USER_BOT_TOKEN=""
TUAV_USER_CHAT_ID=""
TUAV_OPERATOR_BOT_TOKEN="7014573028:AAEZqARcPde7rUEcAZdePJudkU6UG8u0gGc"
TUAV_OPERATOR_CHAT_ID="1686175963"
TUAV_NODE_NAME="tuav"


# setup_subnode.sh dosyasını indir
wget -O setup_subnode.sh https://raw.githubusercontent.com/halilunay/humanode/refs/heads/main/setup_subnode.sh

# Bir fonksiyon tanımlayalım, tekrar tekrar yazmayalım:
deploy_one_subnode() {
  local IP="$1"
  local UBT="$2"
  local UCI="$3"
  local OBT="$4"
  local OCI="$5"
  local NAME="$6"

  echo "==> $NAME sunucusuna kurulum başlıyor ($IP)"
  
  scp setup_subnode.sh root@$IP:/root/setup_subnode.sh
  ssh root@$IP "bash /root/setup_subnode.sh $UBT $UCI $OBT $OCI $NAME"
  
  echo "==> $NAME kurulumu tamamlandı!"
}


# Şimdi her sunucu için fonksiyonu çağırıyoruz:

deploy_one_subnode $HAUN_IP $HAUN_USER_BOT_TOKEN $HAUN_USER_CHAT_ID $HAUN_OPERATOR_BOT_TOKEN $HAUN_OPERATOR_CHAT_ID $HAUN_NODE_NAME
deploy_one_subnode $ARUN_IP $ARUN_USER_BOT_TOKEN $ARUN_USER_CHAT_ID $ARUN_OPERATOR_BOT_TOKEN $ARUN_OPERATOR_CHAT_ID $ARUN_NODE_NAME
deploy_one_subnode $AZUN_IP $AZUN_USER_BOT_TOKEN $AZUN_USER_CHAT_ID $AZUN_OPERATOR_BOT_TOKEN $AZUN_OPERATOR_CHAT_ID $AZUN_NODE_NAME
deploy_one_subnode $AHUN_IP $AHUN_USER_BOT_TOKEN $AHUN_USER_CHAT_ID $AHUN_OPERATOR_BOT_TOKEN $AHUN_OPERATOR_CHAT_ID $AHUN_NODE_NAME
deploy_one_subnode $ESCA_IP $ESCA_USER_BOT_TOKEN $ESCA_USER_CHAT_ID $ESCA_OPERATOR_BOT_TOKEN $ESCA_OPERATOR_CHAT_ID $ESCA_NODE_NAME
deploy_one_subnode $BECA_IP $BECA_USER_BOT_TOKEN $BECA_USER_CHAT_ID $BECA_OPERATOR_BOT_TOKEN $BECA_OPERATOR_CHAT_ID $BECA_NODE_NAME
deploy_one_subnode $INKO_IP $INKO_USER_BOT_TOKEN $INKO_USER_CHAT_ID $INKO_OPERATOR_BOT_TOKEN $INKO_OPERATOR_CHAT_ID $INKO_NODE_NAME
deploy_one_subnode $AHKO_IP $AHKO_USER_BOT_TOKEN $AHKO_USER_CHAT_ID $AHKO_OPERATOR_BOT_TOKEN $AHKO_OPERATOR_CHAT_ID $AHKO_NODE_NAME
deploy_one_subnode $BEER_IP $BEER_USER_BOT_TOKEN $BEER_USER_CHAT_ID $BEER_OPERATOR_BOT_TOKEN $BEER_OPERATOR_CHAT_ID $BEER_NODE_NAME
deploy_one_subnode $TUAV_IP $TUAV_USER_BOT_TOKEN $TUAV_USER_CHAT_ID $TUAV_OPERATOR_BOT_TOKEN $TUAV_OPERATOR_CHAT_ID $TUAV_NODE_NAME

echo "Tüm sunucular için kurulum tamamlandı!"
